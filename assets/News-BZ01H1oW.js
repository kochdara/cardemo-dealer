import{e as m,k as l,w as g,a as s,b as t,c as r,t as _,F as d,d as $,r as i,o as T,L as A,M as G,f as x,g as u,H as O,h as Y,i as q,m as C,_ as J,G as K,E as Q,p as W,l as X}from"./index-BKCPoiO_.js";import{_ as P}from"./Card-BQRz5rvr.js";import{a as L}from"./api-C3-D-LcZ.js";import{_ as Z}from"./SkeletonRetry-DfYmiy5b.js";import{_ as j}from"./Skeleton-BBuTXwCT.js";import{_ as ee}from"./NewsCard-BfYnCDs9.js";import"./index-xsH4HHeE.js";const se={class:"flex items-stratch"},te={class:"flex-1 p-3 flex flex-col justify-between gap-2"},ae={class:"flex flex-col gap-2"},le={class:"grid grid-cols-2"},oe={class:"flex items-center gap-2"},H={__name:"SkeletonNewsCard",setup(b){return(h,f)=>{const e=j,o=P;return l(),m(o,{variant:"soft",class:"bg-white shadow-sm",ui:{body:"p-0 sm:p-0"}},{default:g(()=>[s("div",se,[t(e,{class:"size-32 rounded-l-md"}),s("div",te,[s("div",ae,[t(e,{class:"h-3 w-full rounded-md"}),t(e,{class:"h-3 w-full rounded-md"})]),s("div",le,[s("div",oe,[t(e,{class:"size-4 rounded-full"}),t(e,{class:"h-3 w-full rounded-md"})])])])])]),_:1})}}},ne={class:"w-full bg-white shadow-sm p-3 space-y-3"},ce={class:"grid grid-cols-2"},ie={class:"flex items-center gap-2"},re={class:"p-3 pb-5 space-y-2"},de={class:"text-lg font-semibold mb-2"},ue={__name:"SkeletonNews",setup(b){return(h,f)=>{const e=j;return l(),r(d,null,[s("div",ne,[t(e,{class:"h-60 w-full rounded-md"}),s("div",ce,[s("div",ie,[t(e,{class:"size-4 rounded-full"}),t(e,{class:"h-3 w-full rounded-md"})])]),t(e,{class:"h-3 w-full rounded-md"}),t(e,{class:"h-3 w-full rounded-md"})]),s("div",re,[s("h1",de,_(h.$t("message.news")),1),(l(),r(d,null,$(4,o=>t(H,{key:o})),64))])],64)}}},_e={class:"fixed top-0 left-0 w-full h-13 shadow-md background z-101"},fe={class:"flex justify-start items-center h-full px-3"},me={class:"truncate_wrap text-white text-lg font-semibold"},he={class:"py-13"},ve={class:"w-full h-60"},pe=["src","alt"],we={class:"mt-3 space-y-1"},ge={class:"flex items-center gap-1"},ye={class:"text-13"},xe={class:"flex items-center gap-1"},$e={class:"text-13"},be={class:"truncate_wrap_2 text-default text-lg leading-7.5 font-semibold"},ke={class:"p-3 pb-5 space-y-3"},Ne={class:"text-lg font-semibold mb-2"},Le=Object.assign({name:"news"},{__name:"News",setup(b){const h=Y();q();const f=i(!1),e=i(null),o=i(null),k=i(20),y=i(20),N=i(!1),v=i(!1);T(()=>{z()});async function z(){try{o.value=e.value=null,f.value=!0;const a=await L(null,"news",{},0,y.value);e.value=a.data||null,a.data||(o.value="No news found")}catch(a){o.value=a.toString()}finally{f.value=!1,window.scrollTo(0,0)}}async function M(){if(!v.value){v.value=!0;try{const n=(await L(null,"news",{},k.value,y.value)).data||[];n.length===0?N.value=!1:(e.value||(e.value=[]),e.value.push(...n),k.value+=y.value),await D(1e3)}catch(a){o.value=a.toString()}finally{v.value=!1}}}function S(){const a=window.innerHeight+window.scrollY,n=document.documentElement.offsetHeight;!v.value&&a>=n-540&&M()}A(()=>{window.addEventListener("scroll",S)}),G(()=>{window.removeEventListener("scroll",S)});function D(a){return new Promise(n=>setTimeout(n,a))}return(a,n)=>{var B;const U=K,V=J,F=P,I=O;return l(),r(d,null,[s("header",_e,[s("div",fe,[s("h2",me,_(a.$t("message.news")),1)])]),s("main",he,[f.value?(l(),m(ue,{key:0})):o.value?(l(),m(Z,{key:1,error:o.value,retryPage:z},null,8,["error"])):(l(),r(d,{key:2},[e.value?(l(),m(I,{key:0,to:u(X)(u(h),"news-detail",{slug:"detail",id:(B=e.value[0])==null?void 0:B.id})},{default:g(()=>[t(F,{variant:"soft",class:"w-full bg-white shadow-sm rounded-none",ui:{body:"p-3 sm:p-3"}},{default:g(()=>{var c,p,E;return[s("div",ve,[s("img",{src:((c=e.value[0])==null?void 0:c.image)||u(C),alt:(p=e.value[0])==null?void 0:p.title,class:"rounded-md w-full h-full object-cover",onError:n[0]||(n[0]=w=>w.target.src=u(C))},null,40,pe)]),s("div",we,[t(V,{as:"div",color:"neutral",variant:"ghost",size:"sm",class:"text-muted p-0"},{default:g(()=>{var w,R;return[s("div",ge,[t(U,{name:"i-lucide-calendar-days",class:"size-3.5"}),s("p",ye,_(u(Q)(((w=e.value[0])==null?void 0:w.post_date)||""))+" |",1)]),s("div",xe,[t(U,{name:"i-lucide-eye",class:"size-4"}),s("p",$e,_(u(W)(((R=e.value[0])==null?void 0:R.view)||"0")),1)])]}),_:1}),s("h2",be,_(((E=e.value[0])==null?void 0:E.title)||""),1)])]}),_:1})]),_:1},8,["to"])):x("",!0),s("div",ke,[s("h1",Ne,_(a.$t("message.news")),1),(l(!0),r(d,null,$(e.value||[],(c,p)=>(l(),r(d,{key:c==null?void 0:c.id},[p>0?(l(),m(ee,{key:0,item:c},null,8,["item"])):x("",!0)],64))),128)),N.value&&!o.value?(l(),r(d,{key:0},$(4,c=>t(H,{key:c})),64)):x("",!0)])],64))])],64)}}});export{Le as default};
